<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
  <title>Shiv Video Vision</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json?v=14">
  <meta name="theme-color" content="#ffffff">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <!-- Icons -->
  <link rel="icon" href="assets/icon-192.png">
  <link rel="apple-touch-icon" href="assets/icon-192.png">

  <!-- Styles -->
  <link rel="stylesheet" href="css/style.css?v=14">
  <link rel="stylesheet" href="css/dark.css?v=14">

  <style>
    html, body {
      height: 100%;
      margin: 0;
      overflow: hidden;
      background: #ffffff;
    }

    .splash {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #ffffff;
      padding:
        env(safe-area-inset-top)
        env(safe-area-inset-right)
        env(safe-area-inset-bottom)
        env(safe-area-inset-left);
      z-index: 9999;
    }

    .logoWrap {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      transform: translateZ(0);
      will-change: transform, opacity, filter;
    }

    .logoWrap img {
      width: min(78vw, 320px);
      height: auto;
      transform: scale(.92);
      opacity: 0;
      animation: logoIn 1.4s ease-out forwards;
    }

    .brand {
      margin-top: 14px;
      font-size: 14px;
      color: #666;
      letter-spacing: .08em;
      opacity: 0;
      animation: fadeIn .9s ease-out .35s forwards;
    }

    .glow {
      position: absolute;
      width: min(90vw, 380px);
      height: min(90vw, 380px);
      border-radius: 50%;
      filter: blur(18px);
      opacity: 0;
      transform: scale(.65);
      background:
        radial-gradient(circle at 30% 30%, rgba(255, 0, 128, .35), transparent 55%),
        radial-gradient(circle at 70% 35%, rgba(255, 200, 0, .30), transparent 55%),
        radial-gradient(circle at 45% 75%, rgba(0, 180, 255, .28), transparent 60%),
        radial-gradient(circle at 75% 75%, rgba(50, 255, 120, .22), transparent 60%);
      animation: glowPulse 4.5s ease-in-out .4s forwards;
      pointer-events: none;
      z-index: -1;
    }

    .ring {
      position: absolute;
      width: min(72vw, 300px);
      height: min(72vw, 300px);
      border-radius: 50%;
      border: 2px solid rgba(120, 200, 255, 0.22);
      opacity: 0;
      transform: scale(.6);
      filter: blur(.2px);
      animation: ringBurst 4.8s ease-in-out 1.2s forwards;
      pointer-events: none;
      z-index: -1;
    }

    /* Longer final burst */
    .burst {
      animation: burstOut 3.8s cubic-bezier(.16,.84,.44,1) forwards;
      animation-delay: 3.4s;
    }

    @keyframes logoIn { to { opacity: 1; transform: scale(1); } }
    @keyframes fadeIn { to { opacity: 1; } }

    @keyframes glowPulse {
      0%   { opacity: 0; transform: scale(.65); }
      20%  { opacity: .85; transform: scale(.95); }
      55%  { opacity: .70; transform: scale(1.05); }
      85%  { opacity: .55; transform: scale(1.12); }
      100% { opacity: .00; transform: scale(1.55); }
    }

    @keyframes ringBurst {
      0%   { opacity: 0; transform: scale(.6); }
      20%  { opacity: .65; transform: scale(.95); }
      65%  { opacity: .35; transform: scale(1.25); }
      100% { opacity: 0; transform: scale(1.75); }
    }

    @keyframes burstOut {
      0%   { transform: scale(1); opacity: 1; }
      55%  { transform: scale(1.10); opacity: 1; filter: saturate(1.05); }
      100% { transform: scale(2.9); opacity: 0; filter: saturate(1.25); }
    }

    body.dark, body.dark .splash { background: #0f1115; }
    body.dark .brand { color: #aaa; }
    body.dark .ring { border-color: rgba(140, 200, 255, 0.18); }
  </style>
</head>

<body class="no-scroll">
  <div class="splash">
    <div class="logoWrap burst">
      <div class="glow"></div>
      <div class="ring"></div>
      <img src="assets/logo.png" alt="Shiv Video Vision">
      <div class="brand"></div>
    </div>
  </div>

  <script>
    // Apply saved theme instantly (prevents flash)
    try {
      const t = localStorage.getItem("theme") || "light";
      document.body.classList.toggle("dark", t === "dark");
      const meta = document.querySelector('meta[name="theme-color"]');
      if (meta) meta.setAttribute("content", t === "dark" ? "#0f1115" : "#ffffff");
    } catch(e){}

    // Register Service Worker (if your repo has sw.js at root)
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("./sw.js").catch(console.warn);
      });
    }

    // Redirect after the longer burst animation
    setTimeout(() => {
      const u = localStorage.getItem("username");
      const l = localStorage.getItem("last_login");
      location.replace((u && l) ? "app.html" : "login.html");
    }, 8000);
  </script>
  
</body>
</html>